{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Week 1: Mean/Covariance of a data set and effect of linear transformation\n",
    "\n",
    "In this week, we are going to investigate how the mean and (co)variance of a dataset changes\n",
    "when we apply affine transformation to the dataset."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Learning objectives\n",
    "1. Get Farmiliar with basic programming using Python and Numpy/Scipy.\n",
    "2. Learn to appreciate implementing\n",
    "   functions to compute statistics of dataset in vectorized way.\n",
    "3. Understand the effects of affine transformations on a dataset.\n",
    "4. Understand the importance of testing in programming for machine learning."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Here are a few links for your reference. You may want to refer back to them **throughout** the whole course.\n",
    "\n",
    "- If you are less comfortable with programming in Python, have a look at this Coursera course https://www.coursera.org/learn/python.\n",
    "- To learn more about using Scipy/Numpy, have a look at the [Getting Started Guide](https://scipy.org/getting-started.html). You should also refer to the numpy [documentation](https://docs.scipy.org/doc/) for references of available functions.\n",
    "\n",
    "- If you want to learn more about creating plots in Python, checkout the tutorials found on matplotlib's website \n",
    "https://matplotlib.org/tutorials/index.html. Once you are more familiar with plotting, check out this excellent blog post http://pbpython.com/effective-matplotlib.html.\n",
    "\n",
    "- There are more advanced libraries for interactive data visualization. For example, [bqplot](https://github.com/bloomberg/bqplot) or [d3.js](https://d3js.org/). You may want to check out other libraries if you feel adventurous.\n",
    "\n",
    "- Although we use Jupyter notebook for these exercises, you may also want to check out [Jupyter Lab](https://github.com/jupyterlab/jupyterlab) when you want to work on your own projects.\n",
    "\n",
    "- If you are having issues with the **grader**, be sure to checkout the [Q&A](https://www.coursera.org/learn/pca-machine-learning/discussions/weeks/1/threads/r6WhR1L2Eei7NQqkzSZOZA).\n",
    "\n",
    "- If you are stuck with the programming assignments, you can visit the discussion forum and discuss with your peers."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "First, let's import the packages that we will use for the week. Run the cell below to import the packages."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "# PACKAGE: DO NOT EDIT\n",
    "import numpy as np\n",
    "import matplotlib\n",
    "matplotlib.use('Agg')\n",
    "import matplotlib.pyplot as plt\n",
    "plt.style.use('fivethirtyeight')\n",
    "from sklearn.datasets import fetch_lfw_people, fetch_mldata, fetch_olivetti_faces\n",
    "import time\n",
    "import timeit\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "%matplotlib inline\n",
    "from ipywidgets import interact"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Next, we are going to retrieve Olivetti faces dataset.\n",
    "\n",
    "When working with some datasets, before digging into further analysis, it is almost always\n",
    "useful to do a few things to understand your dataset. First of all, answer the following\n",
    "set of questions:\n",
    "\n",
    "1. What is the size of your dataset?\n",
    "2. What is the dimensionality of your data?\n",
    "\n",
    "The dataset we have are usually stored as 2D matrices, then it would be really important\n",
    "to know which dimension represents the dimension of the dataset, and which represents\n",
    "the data points in the dataset. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Shape of the faces dataset: (400, 4096)\n",
      "400 data points\n"
     ]
    }
   ],
   "source": [
    "image_shape = (64, 64)\n",
    "# Load faces data\n",
    "dataset = fetch_olivetti_faces('./')\n",
    "faces = dataset.data\n",
    "\n",
    "print('Shape of the faces dataset: {}'.format(faces.shape))\n",
    "print('{} data points'.format(faces.shape[0]))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "When your dataset are images, it's a really good idea to see what they look like.\n",
    "\n",
    "One very\n",
    "convenient tool in Jupyter is the `interact` widget, which we use to visualize the images (faces). For more information on how to use interact, have a look at the documentation [here](http://ipywidgets.readthedocs.io/en/stable/examples/Using%20Interact.html)."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "029942aad25447d3a46d8b21b2b01161",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "interactive(children=(IntSlider(value=0, description='n', max=399), Output()), _dom_classes=('widget-interact'â€¦"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "@interact(n=(0, len(faces)-1))\n",
    "def display_faces(n=0):\n",
    "    plt.figure()\n",
    "    plt.imshow(faces[n].reshape((64, 64)), cmap='gray')\n",
    "    plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 1. Mean and Covariance of a Dataset\n",
    "\n",
    "You will now need to implement functions to which compute the mean and covariance of a dataset.\n",
    "\n",
    "There are two ways to compute the mean and covariance. The naive way would be to iterate over the dataset\n",
    "to compute them. This would be implemented as a `for` loop in Python. However, computing them for large\n",
    "dataset would be slow. Alternatively, you can use the functions provided by numpy to compute them, these are much\n",
    "faster as numpy uses machine code to compute them. You will implment function which computes mean and covariane both\n",
    "in the naive way and in the fast way. Later we will compare the performance between these two approaches. If you need to find out which numpy routine to call, have a look at the documentation https://docs.scipy.org/doc/numpy/reference/.\n",
    "It is a good exercise to refer to the official documentation whenever you are not sure about something."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "__When you implement the functions for your assignment, make sure you read\n",
    "the docstring which dimension of your inputs corresponds to the number of data points and which \n",
    "corresponds to the dimension of the dataset.__"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [],
   "source": [
    "# ===YOU SHOULD EDIT THIS FUNCTION===\n",
    "def mean_naive(X):\n",
    "    \"\"\"Compute the mean for a dataset by iterating over the dataset\n",
    "    \n",
    "    Arguments\n",
    "    ---------\n",
    "    X: (N, D) ndarray representing the dataset.\n",
    "        N is the number of samples in the dataset \n",
    "        and D is the feature dimension of the dataset\n",
    "    \n",
    "    Returns\n",
    "    -------\n",
    "    mean: (D, ) ndarray which is the mean of the dataset.\n",
    "    \"\"\"\n",
    "    N, D = X.shape\n",
    "    mean = np.zeros(D)\n",
    "    # The naive approach requires us to iterate over the whole dataset with a for loop.\n",
    "    for n in range(N):\n",
    "        mean += X[n, :]\n",
    "    return mean / N\n",
    "\n",
    "# ===YOU SHOULD EDIT THIS FUNCTION===\n",
    "def cov_naive(X):\n",
    "    \"\"\"Compute the covariance for a dataset\n",
    "    Arguments\n",
    "    ---------\n",
    "    X: (N, D) ndarray representing the dataset. \n",
    "        N is the number of samples in the dataset \n",
    "        and D is the feature dimension of the dataset\n",
    "    \n",
    "    Returns\n",
    "    -------\n",
    "    covariance: (D, D) ndarray which is the covariance matrix of the dataset.\n",
    "    \n",
    "    \"\"\"\n",
    "    N, D = X.shape\n",
    "    covariance = np.zeros((D, D))\n",
    "    T = np.zeros((N, D))\n",
    "    mean = mean_naive(X)\n",
    "    \n",
    "    for i in range(N):\n",
    "        T[i] = X[i, :] - mean\n",
    "        \n",
    "    for i in range(D):\n",
    "        for j in range(D):\n",
    "            covariance[i, j] = covariance[i, j] + T[:, i] @ T[:, j]\n",
    "            \n",
    "    return covariance / (N - 1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [],
   "source": [
    "# GRADED FUNCTION: DO NOT EDIT THIS LINE\n",
    "\n",
    "# ===YOU SHOULD EDIT THIS FUNCTION===\n",
    "def mean(X):\n",
    "    \"\"\"Compute the mean for a dataset\n",
    "    \n",
    "    Arguments\n",
    "    ---------\n",
    "    X: (N, D) ndarray representing the dataset.\n",
    "    \n",
    "    Returns\n",
    "    -------\n",
    "    mean: (D, ) ndarray which is the mean of the dataset.\n",
    "    \"\"\"\n",
    "    mean = np.mean(X, axis=0) # EDIT THIS\n",
    "    return mean\n",
    " \n",
    "# ===YOU SHOULD EDIT THIS FUNCTION===\n",
    "def cov(X):\n",
    "    \"\"\"Compute the covariance for a dataset\n",
    "    Arguments\n",
    "    ---------\n",
    "    X: (N, D) ndarray representing the dataset.\n",
    "    \n",
    "    Returns\n",
    "    -------\n",
    "    covariance_matrix: (D, D) ndarray which is the covariance matrix of the dataset.\n",
    "    \n",
    "    \"\"\"\n",
    "    # It is possible to vectorize our code for computing the covariance, i.e. we do not need to explicitly\n",
    "    # iterate over the entire dataset as looping in Python tends to be slow\n",
    "    N, D = X.shape\n",
    "    covariance_matrix = np.cov(X, rowvar=False) # EDIT THIS\n",
    "    return covariance_matrix"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "With the `mean` function implemented, let's take a look at the _mean_ face of our dataset!"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "def mean_face(faces):\n",
    "    \"\"\"Compute the mean of the `faces`\n",
    "    \n",
    "    Arguments\n",
    "    ---------\n",
    "    faces: (N, 64 * 64) ndarray representing the faces dataset.\n",
    "    \n",
    "    Returns\n",
    "    -------\n",
    "    mean_face: (64, 64) ndarray which is the mean of the faces.\n",
    "    \"\"\"\n",
    "    mean_face = mean(faces)\n",
    "    return mean_face\n",
    "\n",
    "plt.imshow(mean_face(faces).reshape((64, 64)), cmap='gray');"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "To put things into perspective, we can benchmark the two different implementation with the `%time` function\n",
    "in the following way:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "CPU times: user 137 ms, sys: 0 ns, total: 137 ms\n",
      "Wall time: 137 ms\n",
      "CPU times: user 3.94 ms, sys: 0 ns, total: 3.94 ms\n",
      "Wall time: 3.32 ms\n"
     ]
    }
   ],
   "source": [
    "# We have some huge data matrix, and we want to compute its mean\n",
    "X = np.random.randn(100000, 20)\n",
    "# Benchmarking time for computing mean\n",
    "%time mean_naive(X)\n",
    "%time mean(X)\n",
    "pass"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "CPU times: user 746 ms, sys: 609 ms, total: 1.36 s\n",
      "Wall time: 1.33 s\n",
      "CPU times: user 33.6 ms, sys: 94.2 ms, total: 128 ms\n",
      "Wall time: 196 ms\n"
     ]
    }
   ],
   "source": [
    "# Benchmarking time for computing covariance\n",
    "%time cov_naive(X)\n",
    "%time cov(X)\n",
    "pass"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Alternatively, we can also see how running time increases as we increase the size of our dataset.\n",
    "In the following cell, we run `mean`, `mean_naive` and `cov`, `cov_naive` for many times on different sizes of\n",
    "the dataset and collect their running time. If you are less familiar with Python, you may want to spend\n",
    "some time understanding what the code does. __Understanding how your code scales with the size of your dataset (or dimensionality of the dataset) is crucial__ when you want to apply your algorithm to larger dataset. This is really important when we propose alternative methods a more efficient algorithms to solve the same problem. We will use these techniques again later in this course to analyze the running time of our code."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [],
   "source": [
    "def time(f, repeat=10):\n",
    "    \"\"\"A helper function to time the execution of a function.\n",
    "    \n",
    "    Arguments\n",
    "    ---------\n",
    "    f: a function which we want to time it.\n",
    "    repeat: the number of times we want to execute `f`\n",
    "    \n",
    "    Returns\n",
    "    -------\n",
    "    the mean and standard deviation of the execution.\n",
    "    \"\"\"\n",
    "    times = []\n",
    "    for _ in range(repeat):\n",
    "        start = timeit.default_timer()\n",
    "        f()\n",
    "        stop = timeit.default_timer()\n",
    "        times.append(stop-start)\n",
    "    return np.mean(times), np.std(times)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "In the cell below, we compare the running time between `mean` and `mean_naive`, we repeatedly run these functions on a \"fake\" dataset `X`\n",
    "of different sizes and record a list of running_times (`fast_time` and `slow_time`), we then plot the running time against the dataset size to visualize how the running time scales with the size of the dataset."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [],
   "source": [
    "fast_time = []\n",
    "slow_time = []\n",
    "\n",
    "for size in np.arange(100, 5000, step=100):\n",
    "    X = np.random.randn(size, 20) # Create a random dataset with of size (size, 20)\n",
    "    f = lambda : mean(X)\n",
    "    # Record the running time for mean\n",
    "    mu, sigma = time(f)\n",
    "    fast_time.append((size, mu, sigma))\n",
    "    \n",
    "    f = lambda : mean_naive(X)\n",
    "    mu, sigma = time(f)\n",
    "    # Record the running time for mean_naive\n",
    "    slow_time.append((size, mu, sigma))\n",
    "\n",
    "fast_time = np.array(fast_time)\n",
    "slow_time = np.array(slow_time)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "fig, ax = plt.subplots()\n",
    "ax.errorbar(fast_time[:,0], fast_time[:,1], fast_time[:,2], label='fast mean', linewidth=2)\n",
    "ax.errorbar(slow_time[:,0], slow_time[:,1], slow_time[:,2], label='naive mean', linewidth=2)\n",
    "ax.set_xlabel('size of dataset')\n",
    "ax.set_ylabel('running time')\n",
    "plt.legend();"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [],
   "source": [
    "## === FILL IN THIS, follow the approach we have above ===\n",
    "fast_time_cov = []\n",
    "slow_time_cov = []\n",
    "for size in np.arange(100, 5000, step=100):\n",
    "    X = np.random.randn(size, 20)\n",
    "    # Record the running time for cov\n",
    "    f = lambda : cov(X)               # EDIT THIS\n",
    "    mu, sigma = time(f) # EDIT THIS\n",
    "    fast_time_cov.append((size, mu, sigma))\n",
    "    \n",
    "    # Record the running time for cov_naive\n",
    "    f = lambda : cov_naive(X)          # EDIT THIS\n",
    "    mu, sigma = time(f) # EDIT THIS\n",
    "    slow_time_cov.append((size, mu, sigma))\n",
    "\n",
    "fast_time_cov = np.array(fast_time_cov)\n",
    "slow_time_cov = np.array(slow_time_cov)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAbsAAAEGCAYAAAD8PTu1AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADl0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uIDMuMC4yLCBodHRwOi8vbWF0cGxvdGxpYi5vcmcvOIA7rQAAIABJREFUeJzt3XmcFNXV8PHfqe6eGfZVWYdFGEA20SAKCMgSHuMCikvUxJBoNpXkiU+icUlCXHg1i8lrIomfNy5BxD0acXsIRsV9jYAgwgz7sMo2MAyzdNd5/6jqnp6lZxqc6Z7pOd/Ppz9dXXWr6tad6Tp9q27dK6qKMcYYk8mcdGfAGGOMaWwW7IwxxmQ8C3bGGGMyngU7Y4wxGc+CnTHGmIwXTHcGUqGoqMianBpjTIbr0KGDJFpmNTtjjDEZz4KdMcaYjGfBrpr8/Px0Z6HJsrKpm5VPYlY2iVnZJNaQZWPBzhhjTMazYGeMMSbjtYjWmImoKsXFxbiuG5uXk5NDUVFRGnPVdDW3snEch7Zt2yKSsIGWMaaFaNHBrri4mOzsbLKysmLzsrOzycnJSWOumq7mVjbl5eUUFxfTrl27dGfFGJNmLfoypuu6VQKdySxZWVlVau3GmJarRQe7Y9HxoW10fGhburNhjDHmKFiwS7P77ruPMWPG8L3vfe+o1jtw4AD3339/I+Xq6Lz00kv88Y9/THc2jDEmoRZ9z64peOCBB3jqqafo16/fUa1XVFTEAw88wHe/+93GyViSwuEwZ599NmeffXZa82GMaX7azj4TgOIFrzf6vppMzU5EzhKRtSJSICI31rI8W0Se8Je/LyL9/PljRGS5/1ohIhekOu/H6rrrrmPTpk1cfvnlzJ8/n48//pjp06czYcIEpk+fHnugcs2aNUyZMoUzzjiDcePGsX79em699VY2btzIGWecwS9/+csa237ssccYN24c48eP5/vf/z4AW7ZsYcaMGYwbN44ZM2awdetWioqKGDFiROzeVklJCcOGDaOiooIFCxYwefJkxo8fzxVXXEFJSQkAV199NTfffDPnnnsuc+fOZdGiRVx//fUAvPzyy0ydOpUJEyYwc+ZMdu/eDcCdd97JtddeyznnnMNJJ53EfffdV2de9+zZwxVXXMHkyZOZPHky7733XiP9FYwxLUGTqNmJSACYD3wVKAQ+FJHFqvpZXLKrgP2qOlBELgV+A3wdWAWMVtWwiPQAVojI86oaPtp8HM29uGTSHvhOrzqX//GPf+SVV17h+eefp0uXLhw8eJCXXnqJYDDI66+/zm233cbChQt58MEH+eEPf8gll1xCeXk5kUiEuXPnsmbNGt56660a212zZg133303S5YsoUuXLuzfvx+A66+/nksvvZTLL7+chQsX8vOf/5xHH32U4cOH89ZbbzFx4kT+93//lylTphAKhTjvvPOYPXs2AHfccQePPvooc+bMAWD9+vU899xzBAIBFi1aFNv32LFjeeWVVxARHn74Ye655x7mzZsHeL0hPP/88xQXFzN69GiuuuoqCgoKas3rjTfeyDXXXMPYsWPZunUrF154IR988EESfxljjKmpSQQ7YAxQoKobAETkcWAmEB/sZgK/9qefBu4VEVHVkrg0OUCzHeHg4MGDXH311WzYsAERoaKiAoAxY8Zw9913s337ds477zwGDBhQ53beeOMNZs6cSZcuXQDo1KkTAB9++CGPPPIIAJdeeilz584FYNasWTz77LNMnDiRf/zjH7FLo5999hnz5s2jqKiI4uJizjzzzNg+Zs6cSSAQqLHvbdu28Z3vfIddu3ZRXl5O3759Y8umT59OdnY22dnZHHfccezevTthXl9//XU+//zz2LqHDh3i0KFD9hiBMeaYNJVg1wvYGve5EDgtURq/FlcEdAH2iMhpwINAX+CKY6nVgVcTKy0trfNZsmiNrr5a27GYN28eEyZMYNGiRWzevJlzzz0XgIsvvpjRo0ezZMkSZs2axZ/+9Kc67/GpalIPUkfTfO1rX+PWW29l//79rFixgokTJwJwzTXXsGjRIkaMGMGiRYtYtmxZbN02bdrUus0bbriBa6+9lrPPPps333yTu+66K7YsOzs7Nh0IBAiHwwnz6rouS5cupVWrVvUehzHG1KepBLvazszVa2gJ06jq+8AwETkRWCAiL6tqaW07iu9YNCcnp8oJOKq0tNZVjzpNMlSV0tJSSktLOXDgAF27dqW0tJSHH344tmzz5s306dOHb3/726xfv54VK1aQl5fHwYMHa83H6aefzpVXXsmVV15J586d2b9/P506dWL06NE8/vjjXHzxxTz++OOMGTOG0tJSgsEgo0aN4vrrr2fq1KlUVFRQUVFBcXExHTt25NChQzzxxBN0796d0tJSIpEI5eXlsX1XVFQQDocpLS2lqKiILl26UFpayiOPPILrupSWlhIOh6moqIit47ouZWVlCfM6adIk/vKXv3DttdcCsGrVKoYPH37U5Xvw4MHYfcNUsE59E7OySaylls3J/ntdx19f2eTl5SW1r6YS7AqB3LjPvYHtCdIUikgQ6ADsi0+gqmtE5DAwHPioth3FF0xRUVGNWlx9NbuohupJRETIyckhJyeH6667jquvvpq//e1vTJgwIbbsxRdf5MknnyQYDNKtWzduvvlmOnXqxNixY5k8eTLTpk3j9ttvj21z1KhR/OxnP+PCCy/EcRxGjhzJX//6V373u98xZ84c/vrXv9K1a1fmz58fO46LL76Y2bNn88ILL8Tm3XLLLZxzzjnk5uYydOjQWHkFAgGysrJi6UKhEMFgkJycHG666Sa+//3v07NnT0aPHk1hYSE5OTkEg0FCoVBsHcdxyM7OZtCgQbXm9fe//z0/+9nPmDJlCpFIhHHjxh3T4w3t27cnNze3/oQNID8/P+kvXktjZZOYlU3igNWQZSOq6b/F5QevdcBUYBvwIXC5qq6OS3MtMEJVf+g3UJmlqpeISH9gq39psy/wLjBSVfdE1000UnlRUREdOnSoMi+dlzGbumR/CDQltf2NG4udtBKzskmsJZdNfY8eHG3Z1DVSeZOo2fmBag6wBAgAD6rqahG5DfhIVRcDDwALRaQAr0Z3qb/6GcCNIlIBuMA18YGuobXEIGeMMc1dkwh2AKr6EvBStXm/ipsuBS6uZb2FwMJGz6Axxphmq8k8VG6MMcY0Fgt2xhhjMp4FO2OMMRnPgt1Rajv7zFgLImOMMc2DBbtm5sEHH+Sxxx5LdzaO2sUXX8yBAwfSnQ1jTAvVZFpjmuRceeWV6c7CUVFVVJWnnnoq3VkxxrRgVrNLo82bNzNmzBh+/OMfc/rpp3PBBRdw5MgRgITD69x55538+c9/Zu3atUyZMqXKtsaNGwfA8uXLOfvss5k0aRKzZs1i586dNfa9e/duvvGNbzB+/HjGjx/P+++/D8C9997L2LFjGTt2LH/5y18AmDt3bpWBYqN5KC4uZsaMGUycOJFx48bx4osvVjmun/70p0ycOJHCwkJGjBjB3r17Abj88suZNGkSp59+On//+99j2+3Vqxe3334748ePZ9q0abFuvhLl9YknnogNffSTn/yESCTy5f8oxpiMZDW7OG1nn0nbo0hbn2QGJFy/fj33338/f/rTn/j2t7/N4sWL+frXv15jeJ2FCxfygx/8ILbe4MGDKS8vZ9OmTfTr149nn32WCy64gIqKCm644QYeffRRunbtyjPPPMPtt9/O/Pnzq+z35z//OePHj2fRokVEIhGKi4tZvnw5jz76KK+88gqqyrRp0xg/fjyzZs3ipptu4pvf/CYA//znP3n66afJycnhkUceoX379uzdu5dp06bFBnHNz89n/vz53H333TWOef78+XTq1IkjR44wZcoUZsyYQefOnTl8+DCjR4/ml7/8Jb/61a9YsGAB119/fa15Xbt2Lc888wxLliwhFArx05/+lCeffJLLLrus3jI3xrQ8FuzSrG/fvowcORLw+rTcsmULUHN4nalTp9ZY94ILLuDZZ5/luuuu45lnnuGhhx4iPz+fNWvWcP755wNeh8vdunWrse4bb7wRG0A1EAjQoUMH3n33Xc4555zYiAbnnnsu7777Lj/84Q/Zs2cPO3fu5NChQ3Ts2JHc3FwqKiq4/fbbefvtt3Echx07dsRqY7m5uZx66qm1HvN9993HCy+8AHhDAq1fv57OnTuTlZXFWWedFSuL1157LWFen3jiCVasWMHkyZMBryuzrl27Hm3xG2NaCAt2cYoXvF5v/48NPYx89WFvopcxqw+vU9sgrbNmzWL27Nmcd955iAgDBgxg9erVDBkyhKVLlx51XurqJ3XGjBm88MIL7Nu3j1mzZgHw5JNPsmfPHpYtW0YoFGLEiBGxUQ0SDQH05ptvsmzZMpYuXUrr1q0555xzYuuEQqHYcD/RIYDqyutll10WG5PPGGPqYvfsmqji4mK6d+9ORUVFwsYd/fv3JxAI8Nvf/jYWgPLy8tizZ09sVO+KigrWrFlTY91JkybxwAMPABCJRDh48GDsvltJSQmHDx/mxRdfZOzYsQBceOGF/POf/+S5555j5syZgDd8TteuXQmFQrzxxhts3bq1xn6qO3jwIB06dKB169asW7eOjz6qdXCKevM6adIknnvuOb744gsA9u/fH6sVG2NMdRbsmqhbbrmFqVOncv7559fZ6/esWbN48sknY5cts7KyWLBgAXPnzmX8+PFMmDAhFvji3XXXXbz55puMGzeOSZMm8fnnnzNq1Cguv/xypk6d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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "fig, ax = plt.subplots()\n",
    "ax.errorbar(fast_time_cov[:,0], fast_time_cov[:,1], fast_time_cov[:,2], label='fast covariance', linewidth=2)\n",
    "ax.errorbar(slow_time_cov[:,0], slow_time_cov[:,1], slow_time_cov[:,2], label='naive covariance', linewidth=2)\n",
    "ax.set_xlabel('size of dataset')\n",
    "ax.set_ylabel('running time')\n",
    "plt.legend();"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 2. Affine Transformation of Dataset\n",
    "In this week we are also going to verify a few properties about the mean and\n",
    "covariance of affine transformation of random variables.\n",
    "\n",
    "Consider a data matrix $\\boldsymbol{X}$ of size (N, D). We would like to know\n",
    "what is the covariance when we apply an affine transformation $\\boldsymbol{A}\\boldsymbol{x}_i + \\boldsymbol{b}$ with a matrix $\\boldsymbol A$ and a vector $\\boldsymbol b$ to each datapoint $\\boldsymbol{x}_i$ in $\\boldsymbol{X}$, i.e.\n",
    "we would like to know what happens to the mean and covariance for the new dataset if we apply affine transformation."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [],
   "source": [
    "# GRADED FUNCTION: DO NOT EDIT THIS LINE\n",
    "\n",
    "# ===YOU SHOULD EDIT THIS FUNCTION===\n",
    "def affine_mean(mean, A, b):\n",
    "    \"\"\"Compute the mean after affine transformation\n",
    "    Args:\n",
    "        mean: ndarray, the mean vector\n",
    "        A, b: affine transformation applied to x. i.e. Ax + b\n",
    "    Returns:\n",
    "        ndarray of size (D, ): mean vector after affine transformation\n",
    "    \"\"\"\n",
    "    affine_m = A @ mean + b # EDIT THIS\n",
    "    return affine_m\n",
    "\n",
    "# ===YOU SHOULD EDIT THIS FUNCTION===\n",
    "def affine_covariance(S, A, b):\n",
    "    \"\"\"Compute the covariance matrix after affine transformation\n",
    "    Args:\n",
    "        S: ndarray of size (D, D), the covariance matrix\n",
    "        A, b: affine transformation applied to each element in X        \n",
    "    Returns:\n",
    "        ndarray of size (D, D): covariance matrix after the transformation\n",
    "    \"\"\"\n",
    "    affine_cov = A @ S @ A.T # EDIT THIS\n",
    "    return affine_cov"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Once the two functions above are implemented, we can verify the correctness our implementation. Assuming that we have some matrix $\\boldsymbol A$ and vector $\\boldsymbol b$."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {},
   "outputs": [],
   "source": [
    "random = np.random.RandomState(42)\n",
    "A = random.randn(4,4)\n",
    "b = random.randn(4)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Next we can generate some random dataset $\\boldsymbol{X}$"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {},
   "outputs": [],
   "source": [
    "X = random.randn(100, 4)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Assuming that for some dataset $\\boldsymbol X$, the mean and covariance are $\\boldsymbol m$, $\\boldsymbol S$, and for the new dataset after affine transformation $ \\boldsymbol X'$, the mean and covariance are $\\boldsymbol m'$ and $\\boldsymbol S'$, then we would have the following identity:\n",
    "\n",
    "$$\\boldsymbol m' = \\text{affine_mean}(\\boldsymbol m, \\boldsymbol A, \\boldsymbol b)$$\n",
    "\n",
    "$$\\boldsymbol S' = \\text{affine_covariance}(\\boldsymbol S, \\boldsymbol A, \\boldsymbol b)$$"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "metadata": {},
   "outputs": [],
   "source": [
    "X1 = ((A @ (X.T)).T + b)  # applying affine transformation once\n",
    "X2 = ((A @ (X1.T)).T + b) # and again"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "One very useful way to compare whether arrays are equal/similar is use the helper functions\n",
    "in `numpy.testing`. the functions in `numpy.testing` will throw an `AssertionError` when the output does not satisfy the assertion."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "correct\n"
     ]
    }
   ],
   "source": [
    "np.testing.assert_almost_equal(mean(X1), affine_mean(mean(X), A, b))\n",
    "np.testing.assert_almost_equal(cov(X1),  affine_covariance(cov(X), A, b))\n",
    "print('correct')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Fill in the `???` below"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "correct\n"
     ]
    }
   ],
   "source": [
    "np.testing.assert_almost_equal(mean(X2), affine_mean(mean(X1), A, b))\n",
    "np.testing.assert_almost_equal(cov(X2),  affine_covariance(cov(X1), A, b))\n",
    "print('correct')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Check out the numpy [documentation](https://docs.scipy.org/doc/numpy-1.13.0/reference/routines.testing.html)\n",
    "for details.\n",
    "\n",
    "If you are interested in learning more about floating point arithmetic, here is a good [paper](http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.22.6768)."
   ]
  }
 ],
 "metadata": {
  "coursera": {
   "course_slug": "mathematics-machine-learning-pca",
   "graded_item_id": "YoDq1",
   "launcher_item_id": "vCPZ0"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
